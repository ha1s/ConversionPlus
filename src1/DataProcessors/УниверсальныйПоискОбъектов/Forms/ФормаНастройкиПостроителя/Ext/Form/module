

// результата завершения работы
Перем РезультатЗакрытияДиалога Экспорт;


// Обработчик нажатия на кнопку ОК
Процедура ОсновныеДействияФормыОК(Кнопка)
	
	РезультатЗакрытияДиалога = Истина;
	ЭтаФорма.Закрыть();
	
КонецПроцедуры

// Обработчик нажатия на кнопку Отмена
Процедура ОсновныеДействияФормыОтмена(Кнопка)
	
	РезультатЗакрытияДиалога = Ложь;
	ЭтаФорма.Закрыть();
	
КонецПроцедуры

// перед закрытием формы
Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	
	Если ЭтаФорма.Модифицированность
		И НЕ РезультатЗакрытияДиалога Тогда

		РезультатВопроса = Вопрос("Настройки поиска данных изменены. Сохранить?", РежимДиалогаВопрос.ДаНетОтмена);
		
		Если РезультатВопроса = КодВозвратаДиалога.Нет Тогда
			Возврат;
		ИначеЕсли РезультатВопроса=КодВозвратаДиалога.Отмена Тогда
			
			РезультатЗакрытияДиалога = Ложь;
			Отказ = Истина;
			Возврат;
			
		Иначе
			РезультатЗакрытияДиалога = Истина;	
		КонецЕсли;	 					
 
	КонецЕсли;
	
	Если РезультатЗакрытияДиалога = Истина Тогда
		// все отборы с пустым именем - удаляем
		сч = 0;
		Пока сч < Построитель.Отбор.Количество() Цикл
			
			ТекущийОтбор = Построитель.Отбор[сч];
			Если ПустаяСтрока(ТекущийОтбор.Представление)	Тогда
				Построитель.Отбор.Удалить(СЧ);	
			Иначе
				Сч = Сч + 1;
			КонецЕсли;
			
		КонецЦикла;
	КонецЕсли;
		
КонецПроцедуры

// Обработчик нажатия на кнопку По умолчанию
Процедура ОсновныеДействияФормыПоУмолчанию(Кнопка)
	
	Для Каждого СтрокаПолей Из СписокИменПолей Цикл
		
		СтрокаПоляПоУмолчанию = ДеревоМакета.СписокПолей.Найти(СтрокаПолей.Значение, "Значение");
		Если СтрокаПоляПоУмолчанию  = Неопределено Тогда
			СтрокаПолей.Пометка = Ложь;
			Продолжить;
		КонецЕсли;
		
		СтрокаПолей.Пометка = СтрокаПоляПоУмолчанию.Пометка; 
	КонецЦикла;
	
	// для построителя отчетов убираем все галочки ограничений
	УстановитьОтборыПостроителюДляСтрокиДерева(Построитель, ДеревоМакета.НастройкиПостроителя);
	
КонецПроцедуры

// Обработчик нажатия на кнопку ОтметитьВсеПоля
Процедура КоманднаяПанельПоляПоискаОтметитьВсеПоля(Кнопка)
	
	// Установить пометку у всех строк
	СписокИменПолей.ЗаполнитьЗначения(Истина, "Пометка");

КонецПроцедуры

// Обработчик нажатия на кнопку ОтменитьВыделениеВсехПолей
Процедура КоманднаяПанельПоляПоискаОтменитьВыделениеВсехПолей(Кнопка)
	
	// Снять пометку у всех строк
	СписокИменПолей.ЗаполнитьЗначения(Ложь, "Пометка");
	
КонецПроцедуры


РезультатЗакрытияДиалога = Ложь;